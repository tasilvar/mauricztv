!function(e){"use strict";var a='<img src="'+bpmj_eddpayu.admin_url+'images/spinner.gif" style="vertical-align: middle;"> '+bpmj_eddpayu.purchase_loading;function t(t,d){"CARD_TOKEN"===t.type&&t.value&&function(t,d){e(".edd-payu-submit-button").html(a),e("#edd-payu-card-token").val(t),e("#edd-payu-pay-for-recurring-items-only").val(d?"1":"0"),e("#edd-purchase-button").click()}(t.value,d)}window.edd_payu_process_token_response_for_recurring_items=function(e){t(e,!0)},window.edd_payu_process_token_response_for_all_items=function(e){t(e,!1)},e(document).ready(function(){e(document.body).on("edd_discount_applied edd_discount_removed edd_quantity_updated",function(){var a=e('input[name="edd-gateway"]').val();if("payu"===a){var t={action:"bpmj_eddpayu_get_purchase_submit_html","payment-mode":a};e.post(bpmj_eddpayu.ajax_url,t,function(a){e("#edd_purchase_submit").replaceWith(a)})}}),e(document).on("submit","#bpmj-eddpayu-cancel-subscription-form",function(e){if(!confirm(bpmj_eddpayu.confirm_cancel_subscription))return!1}),e(document).on("click","#edd-payu-button-pay-for-all-standard",function(t){e(this).html(a)}),e(document).on("click",".edd-payu-submit-button:not(#edd-payu-button-pay-for-all-standard)",function(t){var d=document.getElementById("edd_purchase_form"),u=e("#edd_purchase_submit"),n=e(this);if(t.preventDefault(),t.stopImmediatePropagation(),("function"!=typeof d.checkValidity||!1!==d.checkValidity())&&!u.data("payu-button-was-clicked")){u.data("payu-button-was-clicked",!0),n.data("payu-purchase-text",n.html()),n.html(a);var r=e("#edd_purchase_form").serialize().replace(/edd_action=[^&]+&?/g,"");r+="&action=bpmj_eddpayu_validate_checkout_form&edd_ajax=true",e.post(bpmj_eddpayu.ajax_url,r,function(a){if("success"===e.trim(a)){e(".edd_errors").remove(),e(".edd-error").hide();var t=n.data("payu-script"),d=n.get(0);e(document.head).append(t);var r=setInterval(function(){e("#payuFrame").length>0?(clearInterval(r),n.html(n.data("payu-purchase-text")),u.data("payu-button-was-clicked",!1),n.replaceWith(n.clone())):e("#"+d.id+"-hidden").click()},50)}else n.html(n.data("payu-purchase-text")),e(".edd-cart-ajax").remove(),e(".edd_errors").remove(),e(".edd-error").hide(),u.before(a),u.data("payu-button-was-clicked",!1)})}})})}(jQuery);